<!doctype html>
<html lang=en>
<meta http-equiv="content-type" content="text/html;charset=utf-8" />

<head>
    <title>APOORV CTF 2025 Writeup</title>
    <meta charset=utf-8>
    <meta name=viewport content="width=device-width,initial-scale=1">
    <meta name=keywords content>
    <meta name=robots content="noodp">
    <link rel=canonical href=index.html>
    <script
        type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","../../../../www.google-analytics.com/analytics.js","ga"),ga("create","UA-202973704-2","auto"),ga("send","pageview"))</script>
    <meta name=twitter:card content="summary_large_image">
    <meta name=twitter:image content="https://https://mburu-karanja.github.io/Bl09/img/ehax_ctf_2025/ehaxctf-logo.jpg">
    <meta name=twitter:title content="Apoorvctf CTF 2025 Writeup">
    <meta name=twitter:site content="@mburu_karanja_">
    <link rel=stylesheet href=../../../styles.css>
    <link rel=stylesheet href=../../../css/style.css>
    <link rel="shortcut icon" href=../../../img/theme-colors/icon.png>
    <link rel=apple-touch-icon href=../../../img/theme-colors/icon.png>
    <meta property="og:locale" content="en">
    <meta property="og:type" content="article">
    <meta property="og:title" content="APOORV CTF 2025 Writeup">
    <meta property="og:url" content="https://mburu-karanja.github.io/Bl09/img/ehax_ctf_2025/">
    <meta property="og:site_name" content>
    <meta property="og:image" content="https://mburu-karanja.github.io/Bl09/img/ehax_ctf_2025/ehaxctf-logo.pnsg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="627">
    <meta property="article:published_time" content="2024-11-17 12:17:45 +0300 +0300">
</head>
<div id=particles-js></div>

<body class=green>
    <div class="container center headings--one-size" style=background:#1f222a;z-index:1>
        <header class=header>
            <div class=header__inner>
                <div class=header__logo><a href=../../../index.html>
                        <div class=logo>cd ~</div>
                    </a></div>
                <ul class="menu menu--mobile">
                    <li class=menu__trigger>Menu&nbsp;▾</li>
                    <li>
                        <ul class=menu__dropdown>
                            <li><a href=../../../about/index.html>About Me</a></li>
                            <li><a href=../../../all-posts/index.html>All Posts</a></li>
                            
                        </ul>
                    </li>
                </ul>
            </div>
            <nav class=navigation-menu>
                <ul class="navigation-menu__inner menu--desktop">
                    <li><a href=../../../about/index.html>About Me</a></li>
                    <li><a href=../../../all-posts/index.html>All Posts</a></li>
            </ul>
            </nav>
        </header>
<div class="content">
    <article class="post">
        <h1 class="post-title"><a href="index.html">APOORVCTF CTF Writeup</a></h1>
        <div class="post-meta"><time class="post-date">2025-03-01</time></div>
        <div class="table-of-contents">
            <h2>Table of Contents</h2>
            <nav id="TableOfContents">
                <ul>
                    <li><a href="#introduction">Introduction</a></li>
                    <li><a href="#part-1">Genjutsu Labyrinth (crypto)</a></li>
                    <li><a href="#part-2">Kowareta Cipher (crypto)</a></li>
                </ul>
            </nav>
        </div>
        <img src="../../../img/Apoorvctf_2025/apoorv-icon.jpg" class="post-cover" alt="APOORV CTF Writeup" title="Cover Image">
        <div class="post-content">
            <div>
                <h2 id="introduction">Introduction<a href="#introduction" class="hanchor" arialabel="Anchor">&#8983;</a></h2>
                <p>This write-up takes you through how I solved two challenges at  <strong>Apoorv CTF</strong>. Both the challenges were <strong>cryptography</strong></p>
                <h2 id="part-1">Genjutsu Labyrinth (crypto)<a href="#part-1" class="hanchor" arialabel="Anchor">&#8983;</a></h2>
                <img
                src=../../../img/Apoorvctf_2025/genjutsu0.jpg class=center
                style=border-radius:8px width="50%">                
                <p>Genjutsu Labyrinth was a <s>grid-based puzzle</s> where I had to move from the top-left corner to the bottom-right using 
                    <strong>XOR operations</strong>. I could only move down (<b>S</b>) or right (<b>D</b>),
                     and my goal was to optimize the final XOR value.
                </p>
                <img
                src=../../../img/Apoorvctf_2025/genjutsu.png class=center
                style=border-radius:8px width="50%">
                
                <p>I just used the same control order till I hit the point and there was the flag.</p>
                <img
                src=../../../img/Apoorvctf_2025/genjutsu1.png class=center
                style=border-radius:8px width="50%">
                <p>Flag: <code>apoorvctf{G3NJUTSU_M4ST3R}</code></p>

                <h2 id="part-2">Kowareta Cipher (crypto)<a href="#part-2" class="hanchor" arialabel="Anchor">&#8983;</a></h2>
                <img
                src=../../../img/Apoorvctf_2025/kowareta1.jpg class=center
                style=border-radius:8px width="50%"> 
                <p>For this one, we had to connect to chals1.apoorvctf.xyz on port 4001. It wanted a <b>hex input</b> and returned <b>ciphertext</b>.
                     My teammate had started solving it, and I jumped in to tweak and improve the script.</p>

                <p>Here’s the updated script:</p>
                <div class="highlight">
                    <pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
                        <code class="language-py" data-lang="py">
                        </span></span><span style=display:flex><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> * 
                    </span></span><span style=display:flex><span style="color:#f92672">import</span> time
                
                </span></span><span style=display:flex><span style="color:#f92672">BLOCK_SIZE</span> = <span style="color:#ae81ff">64</span>
                </span></span><span style=display:flex><span style="color:#f92672">known_flag</span> = b<span style="color:#e6db74">""</span>
                
                </span></span><span style=display:flex><span style="color:#f92672">def</span> recover_flag_byte(i):
                </span></span><span style=display:flex><span style="color:#f92672">pad_length</span> = BLOCK_SIZE - (i + <span style="color:#ae81ff">1</span>)
                </span></span><span style=display:flex><span style="color:#f92672">prefix</span> = b<span style="color:#e6db74">"A"</span> * pad_length
                
                </span></span><span style=display:flex>p = remote(<span style="color:#e6db74">"chals1.apoorvctf.xyz"</span>, <span style="color:#ae81ff">4001</span>)
                
                </span></span><span style=display:flex><span style="color:#f92672">try</span>:
                </span></span><span style=display:flex>p.recvuntil(b<span style="color:#e6db74">"Enter your input: "</span>)
                </span></span><span style=display:flex><span style="color:#f92672">print</span>(f<span style="color:#e6db74">"Recovering byte {i + 1}/{BLOCK_SIZE}..."</span>)
                
                </span></span><span style=display:flex>p.sendline(prefix.hex().encode())
                </span></span><span style=display:flex>p.recvuntil(b<span style="color:#e6db74">"Ciphertext: "</span>)
                </span></span><span style=display:flex>ciphertext_ref = bytes.fromhex(p.recvline().strip().decode())
                
                </span></span><span style=display:flex><span style="color:#f92672">for</span> b <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">256</span>):
                </span></span><span style=display:flex>test_input = prefix + known_flag + bytes([b])
                </span></span><span style=display:flex>p.sendline(test_input.hex().encode())
                </span></span><span style=display:flex>p.recvuntil(b<span style="color:#e6db74">"Ciphertext: "</span>)
                </span></span><span style=display:flex>ciphertext_test = bytes.fromhex(p.recvline().strip().decode())
                
                </span></span><span style=display:flex><span style="color:#f92672">if</span> ciphertext_test[:BLOCK_SIZE] == ciphertext_ref[:BLOCK_SIZE]:
                </span></span><span style=display:flex><span style="color:#f92672">print</span>(f<span style="color:#e6db74">"Recovered: {known_flag.decode(errors='ignore')} + {chr(b)}"</span>)
                </span></span><span style=display:flex><span style="color:#f92672">return</span> bytes([b])
                
                </span></span><span style=display:flex><span style="color:#f92672">return</span> <span style="color:#f92672">None</span>
                </span></span><span style=display:flex><span style="color:#f92672">except</span> EOFError:
                </span></span><span style=display:flex><span style="color:#f92672">print</span>(<span style="color:#e6db74">"Connection dropped. Retrying..."</span>)
                </span></span><span style=display:flex><span style="color:#f92672">return</span> <span style="color:#f92672">None</span>
                </span></span><span style=display:flex><span style="color:#f92672">finally</span>:
                </span></span><span style=display:flex>p.close()
                
                </span></span><span style=display:flex><span style="color:#f92672">for</span> i <span style="color:#f92672">in</span> range(BLOCK_SIZE):
                </span></span><span style=display:flex><span style="color:#f92672">while</span> <span style="color:#f92672">True</span>:
                </span></span><span style=display:flex>byte = recover_flag_byte(i)
                </span></span><span style=display:flex><span style="color:#f92672">if</span> byte:
                </span></span><span style=display:flex>known_flag += byte
                </span></span><span style=display:flex><span style="color:#f92672">break</span>
                </span></span><span style=display:flex><span style="color:#f92672">else</span>:
                </span></span><span style=display:flex>time.sleep(<span style="color:#ae81ff">2</span>)
                
                </span></span><span style=display:flex><span style="color:#f92672">print</span>(<span style="color:#e6db74">"\nRecovered Flag:"</span>, known_flag.decode(errors=<span style="color:#e6db74">"ignore"</span>))
                        </code>
                    </pre>
                </div>
                

                <img
                src=../../../img/Apoorvctf_2025/kowareta.png class=center
                style=border-radius:8px width="50%"> 
                
                <p>Boom! The script successfully recovered the flag:</p>
                <p>Flag: <code>apoorvctf{3cb_345y_crypt0_br43k}
                </code></p>
            </div>
        </div>
    </article>
</div>
<p><em> ApoorvCTF was a blast!  See you in the next one!</em></p>
<div class=pagination>
                    <div class=pagination__title><span class=pagination__title-h>Read other posts</span>
                        <hr>
                    </div>
                    <div class=pagination__buttons><span class="button previous"><a
                                href=../Ehax_ctf_2025/index.html><span class=button__icon>←</span>
                                <span class=button__text>BRONCO CTF 2025 Writeup</span></a></span>
                        <span class="button next"><a href=../OsmosisCTF/index.html><span
                                    class=button__text>OSMOSIS APRIL FOOL'S DAY CTF Writeup</span>
                                <span class=button__icon>→</span></a></span>
                    </div>
                </div>
            </article>
        </div>
        <footer class=footer>
            
            </div>    